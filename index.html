<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-RMM Comprehensive Assessment Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
            max-width: 900px;
            margin: 0 auto;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .function-progress {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .function-progress h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .mini-progress {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 5px;
        }

        .mini-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.3s ease;
        }

        .overall-progress {
            margin-top: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #ecf0f1;
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.3s ease;
        }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(52, 152, 219, 0.1);
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #3498db;
        }

        .stat-label {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 10px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
            gap: 10px;
        }

        .tab {
            flex: 1;
            min-width: 180px;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #7f8c8d;
            font-size: 0.95em;
        }

        .tab.active {
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .tab-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .function-intro {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
        }

        .function-intro h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        .function-intro p {
            color: #5d6d7e;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .subcategory {
            margin-bottom: 40px;
            padding: 25px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #e74c3c;
        }

        .subcategory h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .subcategory-description {
            color: #5d6d7e;
            margin-bottom: 25px;
            font-style: italic;
            padding: 15px;
            background: rgba(52, 152, 219, 0.05);
            border-radius: 8px;
            border-left: 3px solid #3498db;
        }

        .question {
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            border-radius: 12px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e9ecef;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .question-text {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.2em;
            flex: 1;
        }

        .question-id {
            background: #3498db;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .maturity-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 15px;
        }

        .maturity-level {
            padding: 20px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafafa;
            position: relative;
        }

        .maturity-level:hover {
            border-color: #3498db;
            background: #f0f8ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.2);
        }

        .maturity-level.selected {
            border-color: #2ecc71;
            background: linear-gradient(135deg, #d5f4e6, #a8e6cf);
            color: #2c3e50;
            box-shadow: 0 4px 20px rgba(46, 204, 113, 0.3);
        }

        .level-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .level-name {
            font-weight: bold;
            color: #e74c3c;
            font-size: 1.1em;
        }

        .level-number {
            background: #e74c3c;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .maturity-level.selected .level-name,
        .maturity-level.selected .level-number {
            color: #27ae60;
        }

        .maturity-level.selected .level-number {
            background: #27ae60;
        }

        .level-description {
            color: #5d6d7e;
            line-height: 1.5;
            font-size: 0.95em;
        }

        .controls-list {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .control-item {
            background: rgba(255, 255, 255, 0.7);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 6px;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .level-1 { border-left-color: #e74c3c; }
        .level-2 { border-left-color: #f39c12; }
        .level-3 { border-left-color: #f1c40f; }
        .level-4 { border-left-color: #2ecc71; }
        .level-5 { border-left-color: #27ae60; }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .chart-title {
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2c3e50;
            text-align: center;
        }

        .results-summary {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
            transition: transform 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-5px);
        }

        .summary-card h3 {
            font-size: 1.1em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .summary-card .score {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .summary-card .level {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .recommendations {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-radius: 15px;
            border-left: 5px solid #f39c12;
        }

        .recommendations h3 {
            color: #d68910;
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .recommendation-item {
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            border-left: 4px solid #f39c12;
        }

        .recommendation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .recommendation-title {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .priority-badge {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
            color: white;
        }

        .export-section {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
        }

        .export-btn {
            background: linear-gradient(135deg, #8e44ad, #3498db);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px 10px 0;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(142, 68, 173, 0.3);
        }

        .hidden {
            display: none !important;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #7f8c8d;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .maturity-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        .legend-text {
            font-size: 0.9em;
            font-weight: 600;
            color: #2c3e50;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .maturity-levels {
                grid-template-columns: 1fr;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }

            .summary-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }

            .question-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🤖 AI Resilience Maturity Model (AI-RMM)</h1>
            <p>Comprehensive organizational assessment framework based on NIST AI Risk Management Framework. Evaluate your AI-Aware Organizational Resilience across all governance, mapping, measurement, and management functions with detailed controls and evidence-based maturity indicators.</p>
        </div>

        <div class="progress-container">
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-number" id="totalQuestions">17</div>
                    <div class="stat-label">Total Questions</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="answeredQuestions">0</div>
                    <div class="stat-label">Completed</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="remainingQuestions">17</div>
                    <div class="stat-label">Remaining</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="completionPercentage">0%</div>
                    <div class="stat-label">Progress</div>
                </div>
            </div>

            <div class="progress-grid">
                <div class="function-progress">
                    <h4>🏛️ GOVERN</h4>
                    <div class="mini-progress">
                        <div class="mini-progress-fill" id="governProgress"></div>
                    </div>
                    <span id="governProgressText">0 / 5</span>
                </div>
                <div class="function-progress">
                    <h4>🗺️ MAP</h4>
                    <div class="mini-progress">
                        <div class="mini-progress-fill" id="mapProgress"></div>
                    </div>
                    <span id="mapProgressText">0 / 4</span>
                </div>
                <div class="function-progress">
                    <h4>📊 MEASURE</h4>
                    <div class="mini-progress">
                        <div class="mini-progress-fill" id="measureProgress"></div>
                    </div>
                    <span id="measureProgressText">0 / 4</span>
                </div>
                <div class="function-progress">
                    <h4>⚙️ MANAGE</h4>
                    <div class="mini-progress">
                        <div class="mini-progress-fill" id="manageProgress"></div>
                    </div>
                    <span id="manageProgressText">0 / 4</span>
                </div>
            </div>

            <div class="overall-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p style="text-align: center; margin-top: 10px; font-weight: 600;" id="progressText">Overall Assessment Progress: 0%</p>
            </div>
        </div>

        <div style="text-align: center; margin: 20px 0; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 10px;">
            <button onclick="saveProgress(); alert('Progress saved!')" class="export-btn" style="background: #27ae60;">💾 Save Progress</button>
            <button onclick="printAssessment()" class="export-btn" style="background: #8e44ad;">🖨️ Print Summary</button>
            <button onclick="resetAssessment()" class="export-btn" style="background: #e74c3c;">🔄 Reset Assessment</button>
        </div>

        <div class="maturity-legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #e74c3c;"></div>
                <div class="legend-text">Level 1 - Initial</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f39c12;"></div>
                <div class="legend-text">Level 2 - Managed</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f1c40f;"></div>
                <div class="legend-text">Level 3 - Defined</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #2ecc71;"></div>
                <div class="legend-text">Level 4 - Quantitatively Managed</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #27ae60;"></div>
                <div class="legend-text">Level 5 - Optimizing</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('govern')">🏛️ GOVERN</button>
            <button class="tab" onclick="showTab('map')">🗺️ MAP</button>
            <button class="tab" onclick="showTab('measure')">📊 MEASURE</button>
            <button class="tab" onclick="showTab('manage')">⚙️ MANAGE</button>
            <button class="tab" onclick="showTab('results')">📈 RESULTS</button>
        </div>

        <!-- GOVERN Tab -->
        <div id="govern" class="tab-content active">
            <div class="function-intro">
                <h2>🏛️ GOVERN - AI Risk Management Framework</h2>
                <p>The Govern function establishes foundational structures, policies, and accountability mechanisms for effective AI risk management across an organization. This function ensures that AI governance is integrated into organizational culture, with clear roles, responsibilities, and processes for managing AI-related risks throughout the AI lifecycle.</p>
            </div>
            <div id="governContent"></div>
        </div>

        <!-- MAP Tab -->
        <div id="map" class="tab-content">
            <div class="function-intro">
                <h2>🗺️ MAP - AI Risk Management Framework</h2>
                <p>The Map function focuses on foundational understanding and characterization of AI systems within their operational context. This function establishes the essential baseline knowledge needed to identify, categorize, and understand AI systems, their capabilities, risks, and potential impacts before any risk management activities can be effectively implemented.</p>
            </div>
            <div id="mapContent"></div>
        </div>

        <!-- MEASURE Tab -->
        <div id="measure" class="tab-content">
            <div class="function-intro">
                <h2>📊 MEASURE - AI Risk Management Framework</h2>
                <p>The Measure function focuses on quantitative and qualitative assessment of AI systems and their associated risks through systematic measurement and evaluation. This function builds upon the foundational understanding established by the MAP function to provide ongoing assessment capabilities that inform risk management decisions and track performance over time.</p>
            </div>
            <div id="measureContent"></div>
        </div>

        <!-- MANAGE Tab -->
        <div id="manage" class="tab-content">
            <div class="function-intro">
                <h2>⚙️ MANAGE - AI Risk Management Framework</h2>
                <p>The Manage function focuses on operational aspects of AI risk management, ensuring that identified and assessed risks are actively prioritized, responded to, and controlled. This function translates the outputs from the MAP and MEASURE functions into actionable risk management strategies and operational procedures.</p>
            </div>
            <div id="manageContent"></div>
        </div>

        <!-- RESULTS Tab -->
        <div id="results" class="tab-content">
            <h2 style="color: #2c3e50; margin-bottom: 25px; font-size: 1.8em;">📈 AI-RMM Assessment Results</h2>
            <p style="margin-bottom: 30px; color: #5d6d7e; font-size: 1.1em;">Comprehensive analysis of your organization's AI resilience maturity across all four NIST AI-RMF functions with detailed insights and actionable recommendations.</p>
            
            <div class="results-summary">
                <div class="summary-grid">
                    <div class="summary-card">
                        <h3>Overall Maturity</h3>
                        <div class="score" id="overallScore">-</div>
                        <div class="level" id="overallLevel">Complete Assessment</div>
                    </div>
                    <div class="summary-card">
                        <h3>GOVERN</h3>
                        <div class="score" id="governScore">-</div>
                        <div class="level" id="governLevel">Not Assessed</div>
                    </div>
                    <div class="summary-card">
                        <h3>MAP</h3>
                        <div class="score" id="mapScore">-</div>
                        <div class="level" id="mapLevel">Not Assessed</div>
                    </div>
                    <div class="summary-card">
                        <h3>MEASURE</h3>
                        <div class="score" id="measureScore">-</div>
                        <div class="level" id="measureLevel">Not Assessed</div>
                    </div>
                    <div class="summary-card">
                        <h3>MANAGE</h3>
                        <div class="score" id="manageScore">-</div>
                        <div class="level" id="manageLevel">Not Assessed</div>
                    </div>
                </div>

                <div class="dashboard">
                    <div class="chart-container">
                        <div class="chart-title">📊 Maturity Level Distribution</div>
                        <canvas id="maturityChart" width="400" height="300"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">🏛️ Function Comparison</div>
                        <canvas id="functionChart" width="400" height="300"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">📈 Detailed Function Analysis</div>
                        <canvas id="progressChart" width="400" height="300"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">🎯 Maturity Gap Analysis</div>
                        <canvas id="gapChart" width="400" height="300"></canvas>
                    </div>
                </div>

                <div class="recommendations">
                    <h3>🎯 Strategic Recommendations & Action Plan</h3>
                    <div id="recommendationsList">
                        <div class="loading">
                            <div class="spinner"></div>
                            Complete the comprehensive assessment to receive detailed, personalized recommendations based on your organization's specific AI risk management maturity profile.
                        </div>
                    </div>
                </div>

                <div class="export-section">
                    <h3 style="margin-bottom: 20px; color: #2c3e50;">📄 Export Assessment Results</h3>
                    <button class="export-btn" onclick="exportResults('pdf')">📄 Comprehensive PDF Report</button>
                    <button class="export-btn" onclick="exportResults('excel')">📊 Excel Data Analysis</button>
                    <button class="export-btn" onclick="exportResults('json')">💾 Raw Assessment Data</button>
                </div>
            </div>
        </div>
    </div>

<script>
        // Comprehensive AI-RMM Controls Data extracted from Excel
             const aiRmmControls = {
            "govern": {
                "1.1": {
                    "title": "Legal and Regulatory Requirements",
                    "description": "Legal and regulatory requirements involving AI are understood, managed, and documented.",
                    "icon": "⚖️",
                    "controls": {
                        1: "Govern 1.1.1 - Identify all applicable AI-related laws and regulations and on an ad-hoc basis have assessed the potential impact, taking action as necessary.\n\nGovern 1.1.2 - Assess the potential impact of these laws and regulations on organizations with AI systems.",
                        2: "Govern 1.1.3 – Develop and document basic compliance policies and procedures addressing applicable AI legal and regulatory requirements.\n\nGovern 1.1.4 – Assign responsibilities for monitoring compliance with legal obligations across departments managing AI systems.",
                        3: "Govern 1.1.5 – Standardize and apply compliance procedures consistently across all AI systems and projects in the organization.\n\nGovern 1.1.6 – Conduct regular, formal actions on AI-related policies, documenting findings and actions.",
                        4: "Govern 1.1.7 – Use key performance indicators (KPIs) and compliance metrics to document and track adherence to legal and regulatory AI requirements during assessments.\n\nGovern 1.1.8 – Maintain a centralized compliance dashboard or system to track audit outcomes, and legal updates.",
                        5: "Govern 1.1.9 – Continuously improve at a regular predefined cadence, compliance procedures using feedback, legal trend analysis, and post-incident reviews related to AI systems.\n\nGovern 1.1.10 – Proactively monitor changes in AI-related legislation and update internal policies before enforcement deadlines or regulatory shifts."
                    }
                },
                "1.2": {
                    "title": "Trustworthy AI Integration",
                    "description": "The characteristics of trustworthy AI are integrated into organizational policies, processes, procedures, and practices.",
                    "icon": "🛡️",
                    "controls": {
                        1: "Govern 1.2.1 - Identify and document the characteristics of trustworthy, responsible and ethical AI.",
                        2: "Govern 1.2.2 - Define and integrate the basic characteristics of trustworthy, responsible and ethical AI into organizational policies, processes, procedures.",
                        3: "Govern 1.2.3 - Consistently apply the characteristics of trustworthy, responsible and ethical AI into organizational controls and conduct regular compliance assessments.",
                        4: "Govern 1.2.4 - Use metrics and data to evaluate how well trustworthy, responsible, and ethical AI principles are being applied across the organization.",
                        5: "Govern 1.2.5 - Monitor and update characteristics to align with emerging trustworthy AI practices and emerging risks."
                    }
                },
                "1.3": {
                    "title": "Risk Management Processes",
                    "description": "Processes, procedures, and practices are in place to determine the needed level of risk management activities based on the organization's risk tolerance.",
                    "icon": "🎯",
                    "controls": {
                        1: "Govern 1.3.1 - Identify and assess AI-related risks.",
                        2: "Govern 1.3.2 - Prioritize and categorize AI risks and establish an organizational risk tolerance framework.",
                        3: "Govern 1.3.3 - Develop and consistently implement risk mitigation strategies and establish a risk management governance structure.",
                        4: "Govern 1.3.4 - Use metrics and data to monitor and manage AI risks.",
                        5: "Govern 1.3.5 - Continuously monitor and update risk management controls."
                    }
                },
                "2.1": {
                    "title": "Accountability Structures",
                    "description": "Roles and responsibilities and lines of communication related to mapping, measuring, and managing AI risks are documented and clear.",
                    "icon": "👥",
                    "controls": {
                        1: "Govern 2.1.1 - Identify necessary roles and communication channels.",
                        2: "Govern 2.1.2 - Define and document roles and responsibilities and establish communication channels.",
                        3: "Govern 2.1.3 - Implement training and awareness programs.",
                        4: "Govern 2.1.4 - Use metrics and data to assess and maintain roles and communication channels.",
                        5: "Govern 2.1.5 - Continuously evaluate and refine roles and responsibilities."
                    }
                },
                "3.1": {
                    "title": "Workforce Diversity and Inclusion",
                    "description": "Decision-making related to AI risks is informed by a diverse team with varied demographics, disciplines, experience, and expertise.",
                    "icon": "🌍",
                    "controls": {
                        1: "Govern 3.1.1 - Foster a culture of inclusiveness.",
                        2: "Govern 3.1.2 - Establish a diverse risk management team.",
                        3: "Govern 3.1.3 - Leverage diverse perspectives in risk identification.",
                        4: "Govern 3.1.4 - Employ diverse perspectives in risk assessment.",
                        5: "Govern 3.1.5 - Integrate diverse perspectives in risk mitigation."
                    }
                }
            },
            "map": {
                "1.1": {
                    "title": "Context Establishment",
                    "description": "Intended purposes, beneficial uses, context-specific laws, and deployment settings are understood and documented.",
                    "icon": "🎯",
                    "controls": {
                        1: "Map 1.1.1 - Clearly define intended purposes and beneficial uses.\n\nMap 1.1.2 - Identify context-specific laws, norms, and expectations.",
                        2: "Map 1.1.3 - Define prospective deployment settings.\n\nMap 1.1.4 - Understand user expectations and impacts.",
                        3: "Map 1.1.5 - Document assumptions, limitations, and TEVV (Testing and Evaluation with Values).",
                        4: "Map 1.1.6 - Use data and metrics to assess and maintain documentation.",
                        5: "Map 1.1.6 - Conduct continuous mapping throughout the AI lifecycle."
                    }
                },
                "1.2": {
                    "title": "Interdisciplinary Collaboration",
                    "description": "Interdisciplinary AI actors with diverse competencies and skills participate in establishing context.",
                    "icon": "🤝",
                    "controls": {
                        1: "Map 1.2.1 - Foster a culture of inclusiveness and diversity.",
                        2: "Map 1.2.2 - Identify and engage interdisciplinary AI actors.\n\nMap 1.2.3 - Document competencies, skills, and context-establishing capacities.",
                        3: "Map 1.2.4 - Prioritize opportunities for interdisciplinary collaboration.",
                        4: "Map 1.2.5 - Use performance metrics and data to evaluate how well interdisciplinary input improves AI outcomes.",
                        5: "Map 1.2.5 - Continuously evaluate and enhance interdisciplinary collaboration."
                    }
                },
                "2.1": {
                    "title": "AI System Categorization",
                    "description": "Specific tasks and methods used to implement AI system functionality are defined and documented.",
                    "icon": "🏷️",
                    "controls": {
                        1: "Map 2.1.1 - Define specific tasks and use cases for AI system implementation.",
                        2: "Map 2.1.2 - Select appropriate AI techniques and methods for defined tasks.",
                        3: "Map 2.1.3 - Develop comprehensive technical specifications for AI implementation.",
                        4: "Map 2.1.4 - Document AI technique selection and design with performance metrics.",
                        5: "Map 2.1.5 - Integrate AI techniques into system design with continuous optimization."
                    }
                },
                "3.1": {
                    "title": "AI Capabilities and Benefits",
                    "description": "Potential benefits of intended AI system functionality and performance are examined and documented.",
                    "icon": "💎",
                    "controls": {
                        1: "Map 3.1.1 - Identify and evaluate intended benefits of AI system.",
                        2: "Map 3.1.2 - Document potential benefits with clear justifications.",
                        3: "Map 3.1.3 - Prioritize benefits based on organizational priorities with stakeholder communication.",
                        4: "Map 3.1.6 - Use metrics and data to evaluate benefits of AI systems quantitatively.",
                        5: "Map 3.1.5 - Continuously monitor and evaluate actual benefits against expectations."
                    }
                }
            },
            "measure": {
                "1.1": {
                    "title": "Measurement Methods",
                    "description": "Approaches and metrics for measurement of AI risks are selected for implementation starting with the most significant risks.",
                    "icon": "📏",
                    "controls": {
                        1: "Measure 1.1.1 - Select appropriate measurement approaches for most significant AI risks.",
                        2: "Measure 1.1.2 - Develop and implement measurement metrics.\n\nMeasure 1.1.3 - Establish measurement procedures and tools.",
                        3: "Measure 1.1.4 - Integrate measurement into the AI development lifecycle consistently throughout organization.\n\nMeasure 1.1.5 - Document measurement approaches and limitations.",
                        4: "Measure 1.1.6 - Use data and metrics to analyze AI risk measurement effectiveness and trends.",
                        5: "Measure 1.1.6 - Continuously evaluate and improve measurement processes."
                    }
                },
                "2.1": {
                    "title": "Test and Evaluation",
                    "description": "Test sets, metrics, and details about the tools used during Test & Evaluation, Validation & Verification (TEVV) are documented.",
                    "icon": "🧪",
                    "controls": {
                        1: "Measure 2.1.2 - Establish clear test metrics.",
                        2: "Measure 2.1.1 - Develop and document test sets.\n\nMeasure 2.1.3 - Identify and document testing tools.",
                        3: "Measure 2.1.4 - Establish test execution procedures.\n\nMeasure 2.1.5 - Integrate testing into development lifecycle.",
                        4: "Measure 2.1.6 - Document testing results and insights with performance analysis.",
                        5: "Measure 2.1.7 - Continuously evaluate and adapt testing approach."
                    }
                },
                "2.6": {
                    "title": "Safety Risk Evaluation",
                    "description": "AI system is evaluated regularly for safety risks with demonstrated safety capabilities and residual risk management.",
                    "icon": "🛡️",
                    "controls": {
                        1: "Measure 2.6.1 - Establish a safety risk evaluation framework with basic criteria.",
                        2: "Measure 2.6.2 - Develop safety metrics and thresholds with regular assessment procedures.",
                        3: "Measure 2.6.3 - Conduct regular safety risk assessments.\n\nMeasure 2.6.4 - Prioritize safety risk mitigation.\n\nMeasure 2.6.5 - Implement safe fail mechanisms.",
                        4: "Measure 2.6.6 - Use data-driven continuous safety risk monitoring.\n\nMeasure 2.6.7 - Document safety risk evaluation and mitigation.",
                        5: "Measure 2.6.8 - Continuously evaluate and enhance safety risk management with organizational culture."
                    }
                },
                "3.1": {
                    "title": "Risk Tracking Mechanisms",
                    "description": "Approaches, personnel, and documentation are in place to regularly identify and track existing, unanticipated, and emergent AI risks.",
                    "icon": "📈",
                    "controls": {
                        1: "Measure 3.1.1 - Establish risk tracking mechanism for existing and emergent AI risks.",
                        2: "Measure 3.1.2 - Establish risk identification process with severity and likelihood assessment.",
                        3: "Measure 3.1.4 - Prioritize risks with mitigation strategies and reporting mechanisms.",
                        4: "Measure 3.1.6 - Continuously monitor and adapt risk management with trend analysis.",
                        5: "Measure 3.1.7 - Promote risk culture with adaptive tracking approaches and innovation."
                    }
                }
            },
            "manage": {
                "1.1": {
                    "title": "AI System Purpose Achievement",
                    "description": "Determination is made as to whether the AI system achieves its intended purposes and stated objectives.",
                    "icon": "🎯",
                    "controls": {
                        1: "Manage 1.1.1 - Assess AI systems alignment with intended purposes and objectives.",
                        2: "Manage 1.1.2 - Conduct requirements analysis and gap analysis on AI systems.",
                        3: "Manage 1.1.3 - Engage with stakeholders for feedback and validation and evaluate tradeoffs and constraints of AI systems.",
                        4: "Manage 1.1.5 - Use data and metrics to make informed decisions and document rationale and establish governance mechanisms.",
                        5: "Manage 1.1.7 - Continuously monitor and adapt AI systems."
                    }
                },
                "1.2": {
                    "title": "Risk Prioritization",
                    "description": "Treatment of documented AI risks is prioritized based on impact, likelihood, and available resources or methods.",
                    "icon": "⚡",
                    "controls": {
                        1: "Manage 1.2.1 - Prioritize AI risks based on impact and likelihood and categorize and group similar risks and develop basic risk mitigation strategies.",
                        2: "Manage 1.2.3 - Assess resource availability and constraints and implement basic risk mitigation strategies.",
                        3: "Manage 1.2.5 - Implement risk mitigation plans consistently across organization.",
                        4: "Manage 1.2.6 - Use data and metrics to monitor and evaluate risk mitigation effectiveness.",
                        5: "Manage 1.2.7 - Foster a culture of risk awareness and mitigation and continuously monitor and update risk mitigation plans."
                    }
                },
                "2.1": {
                    "title": "Benefit Maximization",
                    "description": "Resources required to manage AI risks are considered along with viable non-AI alternatives to reduce impact magnitude or likelihood.",
                    "icon": "💎",
                    "controls": {
                        1: "Manage 2.1.1 - Identify possible resources and approaches to reduce the magnitude or likelihood of potential impacts.",
                        2: "Manage 2.1.2 - Explore viable non-AI alternatives and evaluate resource allocation and constraints.",
                        3: "Manage 2.1.3 - Minimize AI system reliance across organization and define policies for using resources and methods for minimizing the impact of potential AI risks.",
                        4: "Manage 2.1.4 - Use metrics to measure the effectiveness of existing risk management frameworks.",
                        5: "Manage 2.1.5 - Foster a culture of resource optimization.\n\nManage 2.1.6 - Continuously evaluate and adapt AI risk management strategies."
                    }
                },
                "3.1": {
                    "title": "Third-Party Risk Management",
                    "description": "AI risks and benefits from third-party resources are regularly monitored, and risk controls are applied and documented.",
                    "icon": "🤝",
                    "controls": {
                        1: "Manage 3.1.1 - Identify and evaluate third-party AI resources and associated risks.",
                        2: "Manage 3.1.2 - Establish formal contracts with third-party providers including risk controls.",
                        3: "Manage 3.1.3 - Define monitoring and auditing procedures with data governance controls.",
                        4: "Manage 3.1.5 - Use data and metrics to employ comprehensive risk mitigation strategies.",
                        5: "Manage 3.1.6 - Foster open communication with integrated AI RMF controls in procurement.\n\nManage 3.1.7 - Integrate AI RMF controls into procurement processes."
                    }
                }
            }
        };

        // Global variables
        let assessmentData = {};
        let charts = {};
        let totalQuestions = 0;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeAssessment();
            updateProgress();
            initializeCharts();
        });

        // Initialize assessment with all controls
        function initializeAssessment() {
            totalQuestions = 0;
            
            // Generate content for each function
            ['govern', 'map', 'measure', 'manage'].forEach(functionName => {
                generateFunctionContent(functionName);
            });

            // Update total questions counter
            document.getElementById('totalQuestions').textContent = totalQuestions;
        }

        // Generate content for a specific function
        function generateFunctionContent(functionName) {
            const container = document.getElementById(functionName + 'Content');
            const controls = aiRmmControls[functionName];
            
            let html = '';
            
            Object.keys(controls).forEach(subcategoryKey => {
                const subcategory = controls[subcategoryKey];
                totalQuestions++;
                
                const questionId = `${functionName}-${subcategoryKey}`;
                
                html += `
                    <div class="subcategory level-${Math.ceil(Math.random() * 5)}">
                        <h3>${subcategory.icon} ${functionName.toUpperCase()} ${subcategoryKey} - ${subcategory.title}</h3>
                        <div class="subcategory-description">${subcategory.description}</div>
                        
                        <div class="question" data-question="${questionId}">
                            <div class="question-header">
                                <div class="question-text">How well does your organization implement ${subcategory.title.toLowerCase()}?</div>
                                <div class="question-id">${questionId.toUpperCase()}</div>
                            </div>
                            
                            <div class="maturity-levels">
                                ${generateMaturityLevels(subcategory.controls, questionId)}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Generate maturity level options for a control
        function generateMaturityLevels(controls, questionId) {
            const maturityDescriptions = {
                1: "Ad-hoc, reactive approach with minimal structured responses",
                2: "Basic policies and procedures with localized efforts", 
                3: "Standardized and documented processes consistently applied",
                4: "Measured and proactively managed with metrics and data",
                5: "Continuous learning and refinement driving adaptive systems"
            };

            let html = '';
            
            for (let level = 1; level <= 5; level++) {
                const control = controls[level] || "Control not defined for this level";
                const levelName = ["", "Initial", "Managed", "Defined", "Quantitatively Managed", "Optimizing"][level];
                
                html += `
                    <div class="maturity-level" onclick="selectOption(this, ${level}, '${questionId}')">
                        <div class="level-header">
                            <div class="level-name">Level ${level} - ${levelName}</div>
                            <div class="level-number">${level}</div>
                        </div>
                        <div class="level-description">${maturityDescriptions[level]}</div>
                        <div class="controls-list">
                            <div class="control-item">${control}</div>
                        </div>
                    </div>
                `;
            }
            
            return html;
        }

        // Tab switching functionality
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to selected tab
            event.target.classList.add('active');

            // Update results if results tab is selected
            if (tabName === 'results') {
                updateResults();
            }
        }

        // Option selection functionality
        function selectOption(element, level, questionId) {
            const question = element.closest('.question');
            
            // Remove selected class from all options in this question
            question.querySelectorAll('.maturity-level').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            element.classList.add('selected');
            
            // Store the selection
            assessmentData[questionId] = level;
            
            // Save progress
            saveProgress();
            
            // Update progress
            updateProgress();
            
            // Auto-advance logic
            setTimeout(() => {
                const nextQuestion = question.closest('.subcategory').nextElementSibling;
                if (nextQuestion && nextQuestion.classList.contains('subcategory')) {
                    nextQuestion.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 500);
        }

        // Progress calculation
        function updateProgress() {
            const answeredQuestions = Object.keys(assessmentData).length;
            const progressPercentage = Math.round((answeredQuestions / totalQuestions) * 100);
            
            // Update overall progress
            document.getElementById('progressFill').style.width = progressPercentage + '%';
            document.getElementById('progressText').textContent = `Overall Assessment Progress: ${progressPercentage}%`;
            document.getElementById('answeredQuestions').textContent = answeredQuestions;
            document.getElementById('remainingQuestions').textContent = totalQuestions - answeredQuestions;
            document.getElementById('completionPercentage').textContent = progressPercentage + '%';
            
            // Update function-specific progress
            ['govern', 'map', 'measure', 'manage'].forEach(functionName => {
                const functionQuestions = Object.keys(assessmentData).filter(q => q.startsWith(functionName));
                const functionTotal = Object.keys(aiRmmControls[functionName]).length;
                const functionProgress = functionTotal > 0 ? (functionQuestions.length / functionTotal) * 100 : 0;
                
                document.getElementById(functionName + 'Progress').style.width = functionProgress + '%';
                document.getElementById(functionName + 'ProgressText').textContent = `${functionQuestions.length} / ${functionTotal}`;
            });
        }

        // Calculate function scores
        function calculateFunctionScore(functionName) {
            const functionQuestions = Object.keys(assessmentData).filter(q => q.startsWith(functionName));
            if (functionQuestions.length === 0) return null;
            
            const answers = functionQuestions.map(q => assessmentData[q]);
            const average = answers.reduce((sum, score) => sum + score, 0) / answers.length;
            return Math.round(average * 10) / 10;
        }

        // Get maturity level name
        function getMaturityLevelName(score) {
            if (!score) return "Not Assessed";
            const level = Math.round(score);
            const levels = ["", "Initial", "Managed", "Defined", "Quantitatively Managed", "Optimizing"];
            return levels[level] || "Unknown";
        }

        // Update results display
        function updateResults() {
            // Calculate scores for each function
            const governScore = calculateFunctionScore('govern');
            const mapScore = calculateFunctionScore('map');
            const measureScore = calculateFunctionScore('measure');
            const manageScore = calculateFunctionScore('manage');
            
            // Calculate overall score
            const scores = [governScore, mapScore, measureScore, manageScore].filter(s => s !== null);
            const overallScore = scores.length > 0 ? scores.reduce((sum, score) => sum + score, 0) / scores.length : null;
            
            // Update summary cards
            document.getElementById('overallScore').textContent = overallScore ? overallScore.toFixed(1) : '-';
            document.getElementById('overallLevel').textContent = getMaturityLevelName(overallScore);
            
            document.getElementById('governScore').textContent = governScore ? governScore.toFixed(1) : '-';
            document.getElementById('governLevel').textContent = getMaturityLevelName(governScore);
            
            document.getElementById('mapScore').textContent = mapScore ? mapScore.toFixed(1) : '-';
            document.getElementById('mapLevel').textContent = getMaturityLevelName(mapScore);
            
            document.getElementById('measureScore').textContent = measureScore ? measureScore.toFixed(1) : '-';
            document.getElementById('measureLevel').textContent = getMaturityLevelName(measureScore);
            
            document.getElementById('manageScore').textContent = manageScore ? manageScore.toFixed(1) : '-';
            document.getElementById('manageLevel').textContent = getMaturityLevelName(manageScore);
            
            // Update charts
            updateCharts(governScore, mapScore, measureScore, manageScore, overallScore);
            
            // Generate recommendations
            generateRecommendations(governScore, mapScore, measureScore, manageScore);
        }
		
		// Initialize charts
        // Initialize charts
        function initializeCharts() {
            try {
                const ctx1 = document.getElementById('maturityChart').getContext('2d');
                const ctx2 = document.getElementById('functionChart').getContext('2d');
                const ctx3 = document.getElementById('progressChart').getContext('2d');
                const ctx4 = document.getElementById('gapChart').getContext('2d');

                charts.maturity = new Chart(ctx1, {
                    type: 'doughnut',
                    data: {
                        labels: ['Level 1 - Initial', 'Level 2 - Managed', 'Level 3 - Defined', 'Level 4 - Quantitatively Managed', 'Level 5 - Optimizing'],
                        datasets: [{
                            data: [0, 0, 0, 0, 0],
                            backgroundColor: ['#e74c3c', '#f39c12', '#f1c40f', '#2ecc71', '#27ae60'],
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = total > 0 ? ((context.parsed / total) * 100).toFixed(1) : 0;
                                        return `${context.label}: ${context.parsed} (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });

                charts.function = new Chart(ctx2, {
                    type: 'radar',
                    data: {
                        labels: ['GOVERN', 'MAP', 'MEASURE', 'MANAGE'],
                        datasets: [{
                            label: 'Current Maturity',
                            data: [0, 0, 0, 0],
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.2)',
                            pointBackgroundColor: '#3498db',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            borderWidth: 3
                        }, {
                            label: 'Target (Level 5)',
                            data: [5, 5, 5, 5],
                            borderColor: '#27ae60',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            pointBackgroundColor: '#27ae60',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            borderWidth: 2,
                            borderDash: [5, 5]
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 5,
                                ticks: {
                                    stepSize: 1,
                                    callback: function(value) {
                                        const levels = ['', 'Initial', 'Managed', 'Defined', 'Quant. Managed', 'Optimizing'];
                                        return `${value} - ${levels[value] || ''}`;
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'top'
                            }
                        }
                    }
                });

                charts.progress = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: ['GOVERN', 'MAP', 'MEASURE', 'MANAGE'],
                        datasets: [{
                            label: 'Current Maturity Level',
                            data: [0, 0, 0, 0],
                            backgroundColor: ['#3498db', '#2ecc71', '#f39c12', '#e74c3c'],
                            borderColor: ['#2980b9', '#27ae60', '#d68910', '#c0392b'],
                            borderWidth: 2,
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 5,
                                ticks: {
                                    stepSize: 1,
                                    callback: function(value) {
                                        const levels = ['', 'Initial', 'Managed', 'Defined', 'Quant. Managed', 'Optimizing'];
                                        return levels[value] || value;
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const levels = ['', 'Initial', 'Managed', 'Defined', 'Quantitatively Managed', 'Optimizing'];
                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(1)} (${levels[Math.round(context.parsed.y)] || 'Unknown'})`;
                                    }
                                }
                            }
                        }
                    }
                });

                charts.gap = new Chart(ctx4, {
                    type: 'line',
                    data: {
                        labels: ['GOVERN', 'MAP', 'MEASURE', 'MANAGE'],
                        datasets: [{
                            label: 'Target Maturity (Level 5)',
                            data: [5, 5, 5, 5],
                            borderColor: '#27ae60',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#27ae60',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 6
                        }, {
                            label: 'Current Maturity',
                            data: [0, 0, 0, 0],
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#3498db',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 5,
                                ticks: {
                                    stepSize: 1,
                                    callback: function(value) {
                                        const levels = ['', 'Initial', 'Managed', 'Defined', 'Quant. Managed', 'Optimizing'];
                                        return `${value} - ${levels[value] || ''}`;
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'top'
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                callbacks: {
                                    label: function(context) {
                                        const levels = ['', 'Initial', 'Managed', 'Defined', 'Quantitatively Managed', 'Optimizing'];
                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(1)} (${levels[Math.round(context.parsed.y)] || 'Unknown'})`;
                                    }
                                }
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        }
                    }
                });
            } catch (error) {
                console.error('Error initializing charts:', error);
            }
        }

        // Update charts with new data
        function updateCharts(governScore, mapScore, measureScore, manageScore, overallScore) {
            try {
                // Update maturity distribution chart
                const maturityDistribution = [0, 0, 0, 0, 0];
                Object.values(assessmentData).forEach(score => {
                    if (score >= 1 && score <= 5) {
                        maturityDistribution[score - 1]++;
                    }
                });
                
                if (charts.maturity) {
                    charts.maturity.data.datasets[0].data = maturityDistribution;
                    charts.maturity.update('none');
                }

                // Update function comparison chart
                const functionScores = [
                    governScore || 0,
                    mapScore || 0,
                    measureScore || 0,
                    manageScore || 0
                ];
                
                if (charts.function) {
                    charts.function.data.datasets[0].data = functionScores;
                    charts.function.update('none');
                }

                // Update progress chart
                if (charts.progress) {
                    charts.progress.data.datasets[0].data = functionScores;
                    charts.progress.update('none');
                }

                // Update gap analysis chart
                if (charts.gap) {
                    charts.gap.data.datasets[1].data = functionScores;
                    charts.gap.update('none');
                }
            } catch (error) {
                console.error('Error updating charts:', error);
            }
        }

        // Generate comprehensive recommendations
        function generateRecommendations(governScore, mapScore, measureScore, manageScore) {
            const recommendationsList = document.getElementById('recommendationsList');
            
            if (!governScore && !mapScore && !measureScore && !manageScore) {
                recommendationsList.innerHTML = `
                    <div class="loading">
                        <div class="spinner"></div>
                        Complete the comprehensive assessment to receive detailed, personalized recommendations based on your organization's specific AI risk management maturity profile.
                    </div>
                `;
                return;
            }

            let recommendations = [];

            // Detailed analysis for each function
            const functionAnalysis = {
                'GOVERN': {
                    score: governScore,
                    icon: '🏛️',
                    lowScoreRec: {
                        title: 'Establish AI Governance Foundation',
                        description: 'Your governance maturity needs immediate attention. Focus on establishing clear AI policies, legal compliance frameworks, accountability structures, and diverse decision-making teams. Consider forming an AI governance committee with executive sponsorship and cross-functional representation.'
                    },
                    mediumScoreRec: {
                        title: 'Strengthen Governance Integration',
                        description: 'Good foundation exists but needs better integration. Standardize governance processes across all AI initiatives, implement metrics-driven governance, and ensure consistent application of trustworthy AI principles.'
                    },
                    highScoreRec: {
                        title: 'Optimize Governance Leadership',
                        description: 'Excellent governance maturity! Leverage this strength to mentor other organizations, contribute to industry standards, and drive innovation in AI governance practices.'
                    }
                },
                'MAP': {
                    score: mapScore,
                    icon: '🗺️',
                    lowScoreRec: {
                        title: 'Enhance AI System Understanding',
                        description: 'Critical gaps in AI system mapping. Prioritize comprehensive documentation of AI contexts, capabilities, and impacts. Engage interdisciplinary teams, establish clear categorization frameworks, and invest in risk/benefit mapping capabilities.'
                    },
                    mediumScoreRec: {
                        title: 'Systematize AI Mapping',
                        description: 'Good progress in mapping activities. Focus on standardizing mapping processes, improving stakeholder engagement, and establishing metrics to track mapping effectiveness across all AI systems.'
                    },
                    highScoreRec: {
                        title: 'Advanced Mapping Excellence',
                        description: 'Outstanding mapping capabilities! Use this expertise to develop industry best practices, support continuous mapping throughout AI lifecycles, and share knowledge with the broader AI community.'
                    }
                },
                'MEASURE': {
                    score: measureScore,
                    icon: '📊',
                    lowScoreRec: {
                        title: 'Build Measurement Infrastructure',
                        description: 'Measurement capabilities need significant development. Establish systematic evaluation processes for AI trustworthiness, implement safety and fairness metrics, and create robust risk tracking mechanisms.'
                    },
                    mediumScoreRec: {
                        title: 'Advance Measurement Sophistication',
                        description: 'Solid measurement foundation in place. Enhance with quantitative analysis capabilities, advanced testing frameworks, and comprehensive trustworthiness evaluation across all AI characteristics.'
                    },
                    highScoreRec: {
                        title: 'Measurement Innovation Leadership',
                        description: 'Exceptional measurement maturity! Pioneer new measurement methodologies, contribute to measurement standards development, and help establish industry benchmarks for AI trustworthiness.'
                    }
                },
                'MANAGE': {
                    score: manageScore,
                    icon: '⚙️',
                    lowScoreRec: {
                        title: 'Strengthen Risk Management Operations',
                        description: 'Management functions require immediate improvement. Develop robust incident response procedures, establish third-party risk management protocols, and implement continuous monitoring for deployed AI systems.'
                    },
                    mediumScoreRec: {
                        title: 'Optimize Risk Management',
                        description: 'Good management capabilities established. Focus on data-driven risk prioritization, enhanced benefit maximization strategies, and improved integration of risk management across the AI lifecycle.'
                    },
                    highScoreRec: {
                        title: 'Risk Management Excellence',
                        description: 'Superior risk management maturity! Lead industry best practices, develop advanced risk management frameworks, and contribute to the evolution of AI risk management standards.'
                    }
                }
            };

            // Generate function-specific recommendations
            Object.keys(functionAnalysis).forEach(funcName => {
                const analysis = functionAnalysis[funcName];
                if (analysis.score !== null) {
                    let recommendation;
                    let priority;
                    
                    if (analysis.score < 2.5) {
                        recommendation = analysis.lowScoreRec;
                        priority = analysis.score < 2 ? 'Critical' : 'High';
                    } else if (analysis.score < 4) {
                        recommendation = analysis.mediumScoreRec;
                        priority = 'Medium';
                    } else {
                        recommendation = analysis.highScoreRec;
                        priority = 'Positive';
                    }
                    
                    recommendations.push({
                        priority,
                        area: funcName,
                        icon: analysis.icon,
                        title: recommendation.title,
                        description: recommendation.description,
                        score: analysis.score
                    });
                }
            });

            // Overall organizational recommendations
            const allScores = [governScore, mapScore, measureScore, manageScore].filter(s => s !== null);
            const avgScore = allScores.length > 0 ? allScores.reduce((a, b) => a + b, 0) / allScores.length : 0;
            
            if (avgScore < 2) {
                recommendations.unshift({
                    priority: 'Critical',
                    area: 'ORGANIZATION',
                    icon: '🚨',
                    title: 'Immediate AI Risk Management Overhaul Required',
                    description: 'Your organization shows critical gaps across multiple AI risk management functions. Consider engaging external AI risk management consultants, establishing an AI risk task force, and developing a comprehensive 90-day improvement plan with executive sponsorship.',
                    score: avgScore
                });
            } else if (avgScore >= 4.5) {
                recommendations.push({
                    priority: 'Excellence',
                    area: 'ORGANIZATION',
                    icon: '🏆',
                    title: 'AI Risk Management Center of Excellence',
                    description: 'Your organization demonstrates exceptional AI risk management maturity. Consider establishing a center of excellence, contributing to industry standards, publishing thought leadership, and mentoring other organizations in their AI risk management journey.',
                    score: avgScore
                });
            }

            // Industry-specific recommendations based on maturity patterns
            if (governScore && mapScore && governScore > mapScore + 1) {
                recommendations.push({
                    priority: 'Strategic',
                    area: 'BALANCE',
                    icon: '⚖️',
                    title: 'Balance Governance with Operational Mapping',
                    description: 'Strong governance foundation exists but operational mapping capabilities lag behind. Focus on implementing comprehensive AI system mapping processes to match your governance maturity level.',
                    score: null
                });
            }

            if (measureScore && manageScore && measureScore > manageScore + 1) {
                recommendations.push({
                    priority: 'Strategic',
                    area: 'IMPLEMENTATION',
                    icon: '🔧',
                    title: 'Translate Measurement into Action',
                    description: 'Excellent measurement capabilities exist but management implementation is weaker. Focus on converting measurement insights into actionable risk management strategies and operational improvements.',
                    score: null
                });
            }

            // Add capability-building recommendations
            if (allScores.length > 0 && Math.max(...allScores) < 3) {
                recommendations.push({
                    priority: 'Foundational',
                    area: 'CAPABILITY',
                    icon: '🎓',
                    title: 'Invest in AI Risk Management Capabilities',
                    description: 'Consider comprehensive training programs, hiring specialized AI risk management talent, or partnering with academic institutions to build foundational capabilities across all four functions.',
                    score: null
                });
            }

            // Render recommendations
            let html = '';
            recommendations.forEach(rec => {
                const priorityColors = {
                    'Critical': '#e74c3c',
                    'High': '#f39c12',
                    'Medium': '#3498db',
                    'Strategic': '#9b59b6',
                    'Foundational': '#34495e',
                    'Positive': '#27ae60',
                    'Excellence': '#f1c40f'
                };

                html += `
                    <div class="recommendation-item" style="border-left-color: ${priorityColors[rec.priority]}">
                        <div class="recommendation-header">
                            <div class="recommendation-title">${rec.icon} ${rec.title}</div>
                            <span class="priority-badge" style="background: ${priorityColors[rec.priority]}">${rec.priority}</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 0.9em; margin-bottom: 10px;">
                            Area: ${rec.area}${rec.score ? ` (Current Score: ${rec.score.toFixed(1)})` : ''}
                        </div>
                        <div style="line-height: 1.6;">${rec.description}</div>
                    </div>
                `;
            });

            recommendationsList.innerHTML = html;
        }

        // Advanced analytics functions
        function calculateMaturityTrends() {
            const trends = {
                improvementAreas: [],
                strengths: [],
                gaps: []
            };

            const functionScores = {
                govern: calculateFunctionScore('govern'),
                map: calculateFunctionScore('map'),
                measure: calculateFunctionScore('measure'),
                manage: calculateFunctionScore('manage')
            };

            // Identify strengths (scores >= 4)
            Object.keys(functionScores).forEach(func => {
                if (functionScores[func] >= 4) {
                    trends.strengths.push({
                        function: func.toUpperCase(),
                        score: functionScores[func],
                        level: getMaturityLevelName(functionScores[func])
                    });
                }
            });

            // Identify improvement areas (scores < 3)
            Object.keys(functionScores).forEach(func => {
                if (functionScores[func] && functionScores[func] < 3) {
                    trends.improvementAreas.push({
                        function: func.toUpperCase(),
                        score: functionScores[func],
                        level: getMaturityLevelName(functionScores[func])
                    });
                }
            });

            // Calculate gaps between functions
            const scores = Object.values(functionScores).filter(s => s !== null);
            if (scores.length > 1) {
                const maxScore = Math.max(...scores);
                const minScore = Math.min(...scores);
                const gap = maxScore - minScore;
                
                if (gap > 1.5) {
                    trends.gaps.push({
                        type: 'Function Imbalance',
                        severity: gap > 2.5 ? 'High' : 'Medium',
                        description: `Significant gap (${gap.toFixed(1)}) between highest and lowest performing functions`
                    });
                }
            }

            return trends;
        }

        function generateExecutiveSummary() {
            const summary = {
                overallMaturity: calculateOverallScore(),
                keyFindings: [],
                immediateActions: [],
                strategicRecommendations: []
            };

            const functionScores = {
                govern: calculateFunctionScore('govern'),
                map: calculateFunctionScore('map'),
                measure: calculateFunctionScore('measure'),
                manage: calculateFunctionScore('manage')
            };

            // Generate key findings
            const completedFunctions = Object.values(functionScores).filter(s => s !== null).length;
            const avgScore = summary.overallMaturity;

            if (avgScore) {
                if (avgScore < 2) {
                    summary.keyFindings.push('Organization requires foundational AI risk management development');
                    summary.immediateActions.push('Establish basic AI governance framework');
                    summary.immediateActions.push('Conduct comprehensive AI risk assessment');
                } else if (avgScore < 3) {
                    summary.keyFindings.push('Basic AI risk management foundations exist but need strengthening');
                    summary.immediateActions.push('Standardize AI risk management processes');
                    summary.strategicRecommendations.push('Develop organization-wide AI risk management strategy');
                } else if (avgScore < 4) {
                    summary.keyFindings.push('Solid AI risk management capabilities with room for optimization');
                    summary.strategicRecommendations.push('Implement data-driven risk management approaches');
                    summary.strategicRecommendations.push('Establish AI risk management center of excellence');
                } else {
                    summary.keyFindings.push('Advanced AI risk management maturity achieved');
                    summary.strategicRecommendations.push('Lead industry best practices development');
                    summary.strategicRecommendations.push('Mentor other organizations in AI risk management');
                }
            }

            return summary;
        }


// Export functionality
        function exportResults(format) {
            const results = {
                timestamp: new Date().toISOString(),
                organizationName: 'AI-RMM Assessment Organization',
                assessmentVersion: 'v1.0',
                totalQuestions: totalQuestions,
                completedQuestions: Object.keys(assessmentData).length,
                completionPercentage: Math.round((Object.keys(assessmentData).length / totalQuestions) * 100),
                scores: {
                    govern: calculateFunctionScore('govern'),
                    map: calculateFunctionScore('map'),
                    measure: calculateFunctionScore('measure'),
                    manage: calculateFunctionScore('manage'),
                    overall: calculateOverallScore()
                },
                maturityLevels: {
                    govern: getMaturityLevelName(calculateFunctionScore('govern')),
                    map: getMaturityLevelName(calculateFunctionScore('map')),
                    measure: getMaturityLevelName(calculateFunctionScore('measure')),
                    manage: getMaturityLevelName(calculateFunctionScore('manage')),
                    overall: getMaturityLevelName(calculateOverallScore())
                },
                detailedResponses: assessmentData,
                controlsMapping: Object.keys(assessmentData).map(questionId => {
                    const [func, subcategory] = questionId.split('-');
                    const level = assessmentData[questionId];
                    const control = aiRmmControls[func]?.[subcategory];
                    
                    return {
                        questionId,
                        function: func.toUpperCase(),
                        subcategory,
                        selectedLevel: level,
                        levelName: getMaturityLevelName(level),
                        controlTitle: control?.title || 'Unknown',
                        controlDescription: control?.description || 'Unknown',
                        implementedControl: control?.controls?.[level] || 'Not defined'
                    };
                }),
                recommendations: generateRecommendationsData(),
                analytics: {
                    trends: calculateMaturityTrends(),
                    executiveSummary: generateExecutiveSummary(),
                    gapAnalysis: calculateGapAnalysis()
                }
            };

            switch (format) {
                case 'json':
                    downloadJSON(results);
                    break;
                case 'pdf':
                    generatePDFReport(results);
                    break;
                case 'excel':
                    generateExcelReport(results);
                    break;
            }
        }

        function calculateOverallScore() {
            const scores = [
                calculateFunctionScore('govern'),
                calculateFunctionScore('map'),
                calculateFunctionScore('measure'),
                calculateFunctionScore('manage')
            ].filter(s => s !== null);
            
            return scores.length > 0 ? scores.reduce((sum, score) => sum + score, 0) / scores.length : null;
        }

        function generateRecommendationsData() {
            const governScore = calculateFunctionScore('govern');
            const mapScore = calculateFunctionScore('map');
            const measureScore = calculateFunctionScore('measure');
            const manageScore = calculateFunctionScore('manage');
            
            const recommendations = [];
            const allScores = [governScore, mapScore, measureScore, manageScore].filter(s => s !== null);
            const avgScore = allScores.length > 0 ? allScores.reduce((a, b) => a + b, 0) / allScores.length : 0;
            
            // Generate recommendations based on scores
            if (governScore && governScore < 3) {
                recommendations.push({
                    priority: 'High',
                    area: 'GOVERN',
                    title: 'Strengthen AI Governance',
                    description: 'Establish comprehensive AI governance framework with clear policies and accountability structures.'
                });
            }
            
            if (mapScore && mapScore < 3) {
                recommendations.push({
                    priority: 'High',
                    area: 'MAP',
                    title: 'Improve AI System Mapping',
                    description: 'Develop systematic approach to understanding AI system contexts and capabilities.'
                });
            }
            
            if (measureScore && measureScore < 3) {
                recommendations.push({
                    priority: 'Medium',
                    area: 'MEASURE',
                    title: 'Enhance Measurement Capabilities',
                    description: 'Implement comprehensive AI system evaluation and risk tracking mechanisms.'
                });
            }
            
            if (manageScore && manageScore < 3) {
                recommendations.push({
                    priority: 'Medium',
                    area: 'MANAGE',
                    title: 'Strengthen Risk Management',
                    description: 'Develop robust operational risk management and incident response capabilities.'
                });
            }
            
            return recommendations;
        }

        function calculateGapAnalysis() {
            const functionScores = {
                govern: calculateFunctionScore('govern'),
                map: calculateFunctionScore('map'),
                measure: calculateFunctionScore('measure'),
                manage: calculateFunctionScore('manage')
            };
            
            const gaps = [];
            const scores = Object.values(functionScores).filter(s => s !== null);
            
            if (scores.length > 1) {
                const maxScore = Math.max(...scores);
                const minScore = Math.min(...scores);
                const gap = maxScore - minScore;
                
                gaps.push({
                    type: 'Function Imbalance',
                    severity: gap > 2 ? 'High' : gap > 1 ? 'Medium' : 'Low',
                    gap: gap.toFixed(1),
                    description: `Gap between highest (${maxScore.toFixed(1)}) and lowest (${minScore.toFixed(1)}) performing functions`
                });
            }
            
            // Target gaps (assuming target of Level 4 for mature organizations)
            const targetLevel = 4;
            Object.keys(functionScores).forEach(func => {
                if (functionScores[func] && functionScores[func] < targetLevel) {
                    const gap = targetLevel - functionScores[func];
                    gaps.push({
                        type: 'Target Gap',
                        function: func.toUpperCase(),
                        severity: gap > 2 ? 'High' : gap > 1 ? 'Medium' : 'Low',
                        gap: gap.toFixed(1),
                        description: `${func.toUpperCase()} is ${gap.toFixed(1)} levels below target maturity`
                    });
                }
            });
            
            return gaps;
        }

        function downloadJSON(data) {
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ai-rmm-comprehensive-assessment-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function generatePDFReport(results) {
            let reportHtml = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>AI-RMM Comprehensive Assessment Report</title>
                    <style>
                        body { 
                            font-family: 'Segoe UI', Arial, sans-serif; 
                            margin: 40px; 
                            line-height: 1.6; 
                            color: #333; 
                            background: white;
                        }
                        .header { 
                            text-align: center; 
                            border-bottom: 3px solid #3498db; 
                            padding-bottom: 20px; 
                            margin-bottom: 30px; 
                        }
                        .header h1 { 
                            color: #2c3e50; 
                            font-size: 2.2em; 
                            margin-bottom: 10px; 
                            font-weight: 700;
                        }
                        .header .subtitle {
                            color: #7f8c8d;
                            font-size: 1.1em;
                            margin-bottom: 15px;
                        }
                        .meta-info { 
                            background: #f8f9fa; 
                            padding: 25px; 
                            border-radius: 8px; 
                            margin-bottom: 30px;
                            border-left: 4px solid #3498db;
                        }
                        .meta-info h3 {
                            color: #2c3e50;
                            margin-bottom: 15px;
                            font-size: 1.3em;
                        }
                        .section { 
                            margin-bottom: 40px; 
                            page-break-inside: avoid;
                        }
                        .section h2 { 
                            color: #3498db; 
                            border-bottom: 2px solid #ecf0f1; 
                            padding-bottom: 10px;
                            font-size: 1.6em;
                            margin-bottom: 20px;
                        }
                        .score-grid { 
                            display: grid; 
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
                            gap: 20px; 
                            margin: 20px 0; 
                        }
                        .score-card { 
                            padding: 20px; 
                            border: 2px solid #ecf0f1; 
                            border-radius: 8px; 
                            text-align: center;
                            background: white;
                        }
                        .score-card h3 { 
                            margin-bottom: 10px; 
                            color: #2c3e50;
                            font-size: 1.1em;
                        }
                        .score-card .score { 
                            font-size: 2.2em; 
                            font-weight: bold; 
                            color: #3498db;
                            margin-bottom: 5px;
                        }
                        .score-card .level { 
                            color: #7f8c8d; 
                            font-style: italic;
                            font-size: 0.9em;
                        }
                        .controls-table { 
                            width: 100%; 
                            border-collapse: collapse; 
                            margin: 20px 0;
                            font-size: 0.9em;
                        }
                        .controls-table th, .controls-table td { 
                            padding: 12px 8px; 
                            text-align: left; 
                            border-bottom: 1px solid #ddd; 
                            vertical-align: top;
                        }
                        .controls-table th { 
                            background-color: #f8f9fa; 
                            font-weight: bold;
                            color: #2c3e50;
                        }
                        .level-1 { background-color: #fdf2f2; }
                        .level-2 { background-color: #fef9e7; }
                        .level-3 { background-color: #fffacd; }
                        .level-4 { background-color: #f0fff4; }
                        .level-5 { background-color: #f0f8f0; }
                        .recommendations { 
                            background: #fff3cd; 
                            padding: 25px; 
                            border-radius: 8px; 
                            border-left: 5px solid #f39c12;
                            margin: 20px 0;
                        }
                        .recommendations h3 {
                            color: #d68910;
                            margin-bottom: 15px;
                            font-size: 1.3em;
                        }
                        .recommendation-item {
                            background: white;
                            padding: 15px;
                            margin-bottom: 15px;
                            border-radius: 6px;
                            border-left: 3px solid #f39c12;
                        }
                        .recommendation-header {
                            font-weight: bold;
                            color: #2c3e50;
                            margin-bottom: 8px;
                        }
                        .priority-high { border-left-color: #e74c3c !important; }
                        .priority-medium { border-left-color: #3498db !important; }
                        .priority-low { border-left-color: #2ecc71 !important; }
                        .footer { 
                            text-align: center; 
                            margin-top: 50px; 
                            padding-top: 20px; 
                            border-top: 2px solid #ecf0f1; 
                            color: #7f8c8d;
                            font-size: 0.9em;
                        }
                        .analytics-section {
                            background: #f8f9fa;
                            padding: 20px;
                            border-radius: 8px;
                            margin: 20px 0;
                        }
                        .gap-item {
                            background: white;
                            padding: 15px;
                            margin-bottom: 10px;
                            border-radius: 6px;
                            border-left: 3px solid #e74c3c;
                        }
                        .gap-severity-high { border-left-color: #e74c3c; }
                        .gap-severity-medium { border-left-color: #f39c12; }
                        .gap-severity-low { border-left-color: #2ecc71; }
                        @media print { 
                            body { margin: 20px; font-size: 12px; }
                            .score-grid { grid-template-columns: repeat(2, 1fr); }
                            .section { page-break-inside: avoid; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>🤖 AI Resilience Maturity Model Assessment Report</h1>
                        <div class="subtitle">Comprehensive Organizational AI Risk Management Evaluation</div>
                        <p><strong>Generated:</strong> ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
                    </div>
                    
                    <div class="meta-info">
                        <h3>📋 Assessment Overview</h3>
                        <p><strong>Assessment Version:</strong> ${results.assessmentVersion}</p>
                        <p><strong>Total Questions:</strong> ${results.totalQuestions}</p>
                        <p><strong>Completed Questions:</strong> ${results.completedQuestions}</p>
                        <p><strong>Completion Rate:</strong> ${results.completionPercentage}%</p>
                        <p><strong>Overall Maturity Score:</strong> ${results.scores.overall ? results.scores.overall.toFixed(2) : 'Incomplete'}</p>
                        <p><strong>Overall Maturity Level:</strong> ${results.maturityLevels.overall}</p>
                    </div>
                    
                    <div class="section">
                        <h2>📊 Executive Summary</h2>
                        <div class="score-grid">
                            <div class="score-card">
                                <h3>🏛️ GOVERN</h3>
                                <div class="score">${results.scores.govern ? results.scores.govern.toFixed(1) : 'N/A'}</div>
                                <div class="level">${results.maturityLevels.govern}</div>
                            </div>
                            <div class="score-card">
                                <h3>🗺️ MAP</h3>
                                <div class="score">${results.scores.map ? results.scores.map.toFixed(1) : 'N/A'}</div>
                                <div class="level">${results.maturityLevels.map}</div>
                            </div>
                            <div class="score-card">
                                <h3>📊 MEASURE</h3>
                                <div class="score">${results.scores.measure ? results.scores.measure.toFixed(1) : 'N/A'}</div>
                                <div class="level">${results.maturityLevels.measure}</div>
                            </div>
                            <div class="score-card">
                                <h3>⚙️ MANAGE</h3>
                                <div class="score">${results.scores.manage ? results.scores.manage.toFixed(1) : 'N/A'}</div>
                                <div class="level">${results.maturityLevels.manage}</div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h2>📈 Detailed Assessment Results</h2>
                        <table class="controls-table">
                            <thead>
                                <tr>
                                    <th>Function</th>
                                    <th>Control Area</th>
                                    <th>Maturity Level</th>
                                    <th>Level Name</th>
                                    <th>Control Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${results.controlsMapping.map(control => `
                                    <tr class="level-${control.selectedLevel}">
                                        <td><strong>${control.function}</strong></td>
                                        <td>${control.controlTitle}</td>
                                        <td style="text-align: center; font-weight: bold;">${control.selectedLevel}</td>
                                        <td>${control.levelName}</td>
                                        <td style="font-size: 0.85em;">${control.controlDescription}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>

                    <div class="section">
                        <h2>🎯 Gap Analysis</h2>
                        <div class="analytics-section">
                            <h4>Identified Gaps:</h4>
                            ${results.analytics.gapAnalysis.map(gap => `
                                <div class="gap-item gap-severity-${gap.severity.toLowerCase()}">
                                    <div class="recommendation-header">${gap.type}${gap.function ? ` - ${gap.function}` : ''}</div>
                                    <div><strong>Severity:</strong> ${gap.severity} | <strong>Gap:</strong> ${gap.gap} levels</div>
                                    <div>${gap.description}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="recommendations">
                        <h3>🎯 Strategic Recommendations</h3>
                        <p>Based on your assessment results, focus on the following priorities:</p>
                        ${results.recommendations.map(rec => `
                            <div class="recommendation-item priority-${rec.priority.toLowerCase()}">
                                <div class="recommendation-header">${rec.title} (${rec.area})</div>
                                <div><strong>Priority:</strong> ${rec.priority}</div>
                                <div>${rec.description}</div>
                            </div>
                        `).join('')}
                        
                        <h4>Next Steps:</h4>
                        <ul>
                            <li><strong>Immediate Actions:</strong> Address any functions scoring below Level 3 with targeted improvement initiatives.</li>
                            <li><strong>Short-term Goals:</strong> Standardize processes across all AI risk management functions.</li>
                            <li><strong>Long-term Vision:</strong> Develop quantitative management capabilities and continuous optimization practices.</li>
                            <li><strong>Best Practices:</strong> Leverage high-performing areas as organizational strengths and knowledge-sharing opportunities.</li>
                        </ul>
                    </div>

                    <div class="footer">
                        <p><strong>AI Resilience Maturity Model (AI-RMM) Assessment</strong></p>
                        <p>Based on NIST AI Risk Management Framework • Framework Version v1.0</p>
                        <p>This report is generated for organizational improvement purposes and should be treated as confidential.</p>
                        <p><em>For questions about this assessment, please refer to the AI-RMM documentation or contact your AI risk management team.</em></p>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([reportHtml], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ai-rmm-comprehensive-report-${new Date().toISOString().split('T')[0]}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function generateExcelReport(results) {
            let csv = 'AI Resilience Maturity Model (AI-RMM) - Comprehensive Assessment Results\n\n';
            csv += `Assessment Date,${new Date().toLocaleDateString()}\n`;
            csv += `Assessment Time,${new Date().toLocaleTimeString()}\n`;
            csv += `Assessment Version,${results.assessmentVersion}\n`;
            csv += `Total Questions,${results.totalQuestions}\n`;
            csv += `Completed Questions,${results.completedQuestions}\n`;
            csv += `Completion Rate,${results.completionPercentage}%\n`;
            csv += `Overall Score,${results.scores.overall ? results.scores.overall.toFixed(2) : 'N/A'}\n`;
            csv += `Overall Level,${results.maturityLevels.overall}\n\n`;
            
            csv += 'Function Scores Summary\n';
            csv += 'Function,Score,Maturity Level,Gap to Target (Level 4)\n';
            csv += `GOVERN,${results.scores.govern ? results.scores.govern.toFixed(2) : 'N/A'},${results.maturityLevels.govern},${results.scores.govern ? (4 - results.scores.govern).toFixed(1) : 'N/A'}\n`;
            csv += `MAP,${results.scores.map ? results.scores.map.toFixed(2) : 'N/A'},${results.maturityLevels.map},${results.scores.map ? (4 - results.scores.map).toFixed(1) : 'N/A'}\n`;
            csv += `MEASURE,${results.scores.measure ? results.scores.measure.toFixed(2) : 'N/A'},${results.maturityLevels.measure},${results.scores.measure ? (4 - results.scores.measure).toFixed(1) : 'N/A'}\n`;
            csv += `MANAGE,${results.scores.manage ? results.scores.manage.toFixed(2) : 'N/A'},${results.maturityLevels.manage},${results.scores.manage ? (4 - results.scores.manage).toFixed(1) : 'N/A'}\n\n`;
            
            csv += 'Detailed Control Assessment\n';
            csv += 'Function,Subcategory,Control Title,Selected Level,Level Name,Control Description,Implemented Control\n';
            results.controlsMapping.forEach(control => {
                const cleanDescription = control.controlDescription.replace(/"/g, '""');
                const cleanImplemented = control.implementedControl.replace(/"/g, '""').substring(0, 200) + '...';
                csv += `"${control.function}","${control.subcategory}","${control.controlTitle}",${control.selectedLevel},"${control.levelName}","${cleanDescription}","${cleanImplemented}"\n`;
            });

            csv += '\nRecommendations\n';
            csv += 'Priority,Area,Title,Description\n';
            results.recommendations.forEach(rec => {
                const cleanDescription = rec.description.replace(/"/g, '""');
                csv += `"${rec.priority}","${rec.area}","${rec.title}","${cleanDescription}"\n`;
            });

            csv += '\nGap Analysis\n';
            csv += 'Gap Type,Function,Severity,Gap Size,Description\n';
            results.analytics.gapAnalysis.forEach(gap => {
                csv += `"${gap.type}","${gap.function || 'N/A'}","${gap.severity}","${gap.gap}","${gap.description.replace(/"/g, '""')}"\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ai-rmm-comprehensive-assessment-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Auto-save functionality
        function saveProgress() {
            try {
                const progressData = {
                    assessmentData: assessmentData,
                    timestamp: new Date().toISOString(),
                    version: 'v1.0'
                };
                localStorage.setItem('ai-rmm-comprehensive-assessment', JSON.stringify(progressData));
                console.log('Progress saved successfully');
            } catch (error) {
                console.error('Error saving progress:', error);
                alert('Warning: Could not save progress to browser storage.');
            }
        }

        function loadProgress() {
            try {
                const saved = localStorage.getItem('ai-rmm-comprehensive-assessment');
                if (saved) {
                    const progressData = JSON.parse(saved);
                    assessmentData = progressData.assessmentData || {};
                    
                    // Restore UI state
                    Object.keys(assessmentData).forEach(questionId => {
                        const question = document.querySelector(`[data-question="${questionId}"]`);
                        if (question) {
                            const selectedLevel = assessmentData[questionId];
                            const levelOptions = question.querySelectorAll('.maturity-level');
                            levelOptions.forEach((option, index) => {
                                option.classList.remove('selected');
                                if (index + 1 === selectedLevel) {
                                    option.classList.add('selected');
                                }
                            });
                        }
                    });
                    updateProgress();
                    console.log('Progress loaded successfully');
                }
            } catch (error) {
                console.error('Error loading saved progress:', error);
                assessmentData = {};
            }
        }

        // Utility functions
        function resetAssessment() {
            if (confirm('Are you sure you want to reset the entire assessment? This action cannot be undone.')) {
                assessmentData = {};
                localStorage.removeItem('ai-rmm-comprehensive-assessment');
                
                // Reset UI
                document.querySelectorAll('.maturity-level.selected').forEach(option => {
                    option.classList.remove('selected');
                });
                
                updateProgress();
                updateResults();
                
                alert('Assessment has been reset successfully.');
            }
        }

        function printAssessment() {
            // Create a print-friendly version
            const printWindow = window.open('', '_blank');
            const printContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>AI-RMM Assessment Summary</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            margin: 20px; 
                            line-height: 1.4;
                            color: #333;
                        }
                        .header {
                            text-align: center;
                            border-bottom: 2px solid #3498db;
                            padding-bottom: 15px;
                            margin-bottom: 25px;
                        }
                        .summary { 
                            margin-bottom: 30px; 
                            background: #f8f9fa;
                            padding: 20px;
                            border-radius: 6px;
                        }
                        .function-section { 
                            margin-bottom: 25px; 
                            border-bottom: 1px solid #ddd; 
                            padding-bottom: 15px; 
                        }
                        .score { 
                            font-size: 1.3em; 
                            font-weight: bold; 
                            color: #3498db; 
                        }
                        .progress-info {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                            gap: 15px;
                            margin: 15px 0;
                        }
                        .progress-item {
                            text-align: center;
                            padding: 10px;
                            background: #ecf0f1;
                            border-radius: 4px;
                        }
                        @media print { 
                            body { margin: 15px; font-size: 11px; }
                            .progress-info { grid-template-columns: repeat(2, 1fr); }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>🤖 AI-RMM Assessment Summary</h1>
                        <p>Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
                    </div>
                    
                    <div class="summary">
                        <h3>Assessment Overview</h3>
                        <div class="progress-info">
                            <div class="progress-item">
                                <div><strong>Completion Rate</strong></div>
                                <div class="score">${Math.round((Object.keys(assessmentData).length / totalQuestions) * 100)}%</div>
                            </div>
                            <div class="progress-item">
                                <div><strong>Overall Score</strong></div>
                                <div class="score">${calculateOverallScore()?.toFixed(1) || 'N/A'}</div>
                            </div>
                            <div class="progress-item">
                                <div><strong>Questions Completed</strong></div>
                                <div class="score">${Object.keys(assessmentData).length} / ${totalQuestions}</div>
                            </div>
                            <div class="progress-item">
                                <div><strong>Maturity Level</strong></div>
                                <div class="score">${getMaturityLevelName(calculateOverallScore())}</div>
                            </div>
                        </div>
                    </div>
                    
                    <h3>Function Breakdown</h3>
                    <div class="function-section">
                        <h4>🏛️ GOVERN: <span class="score">${calculateFunctionScore('govern')?.toFixed(1) || 'N/A'}</span></h4>
                    <div class="function-section">
                        <h4>🗺️ MAP: <span class="score">${calculateFunctionScore('map')?.toFixed(1) || 'N/A'}</span></h4>
                        <p><strong>Maturity Level:</strong> ${getMaturityLevelName(calculateFunctionScore('map'))}</p>
                        <p><strong>Description:</strong> Understanding and characterization of AI systems within their operational context.</p>
                    </div>
                    
                    <div class="function-section">
                        <h4>📊 MEASURE: <span class="score">${calculateFunctionScore('measure')?.toFixed(1) || 'N/A'}</span></h4>
                        <p><strong>Maturity Level:</strong> ${getMaturityLevelName(calculateFunctionScore('measure'))}</p>
                        <p><strong>Description:</strong> Quantitative and qualitative assessment of AI systems and associated risks.</p>
                    </div>
                    
                    <div class="function-section">
                        <h4>⚙️ MANAGE: <span class="score">${calculateFunctionScore('manage')?.toFixed(1) || 'N/A'}</span></h4>
                        <p><strong>Maturity Level:</strong> ${getMaturityLevelName(calculateFunctionScore('manage'))}</p>
                        <p><strong>Description:</strong> Operational aspects ensuring identified risks are actively prioritized and controlled.</p>
                    </div>

                    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ccc; text-align: center; font-size: 0.9em; color: #666;">
                        <p><strong>AI Resilience Maturity Model (AI-RMM) Assessment</strong></p>
                        <p>Based on NIST AI Risk Management Framework • Framework Version v1.0</p>
                    </div>
                </body>
                </html>
            `;
            
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }

        // Advanced utility functions
        function exportAssessmentData() {
            const exportData = {
                metadata: {
                    exportDate: new Date().toISOString(),
                    assessmentVersion: 'v1.0',
                    totalQuestions: totalQuestions,
                    completedQuestions: Object.keys(assessmentData).length
                },
                responses: assessmentData,
                scores: {
                    govern: calculateFunctionScore('govern'),
                    map: calculateFunctionScore('map'),
                    measure: calculateFunctionScore('measure'),
                    manage: calculateFunctionScore('manage'),
                    overall: calculateOverallScore()
                },
                analytics: {
                    trends: calculateMaturityTrends(),
                    gaps: calculateGapAnalysis()
                }
            };
            
            return exportData;
        }

        function importAssessmentData(jsonData) {
            try {
                const importedData = JSON.parse(jsonData);
                if (importedData.responses) {
                    assessmentData = importedData.responses;
                    saveProgress();
                    loadProgress();
                    updateProgress();
                    updateResults();
                    alert('Assessment data imported successfully!');
                } else {
                    alert('Invalid assessment data format.');
                }
            } catch (error) {
                console.error('Import error:', error);
                alert('Error importing assessment data. Please check the file format.');
            }
        }

        function validateAssessmentCompleteness() {
            const incomplete = [];
            
            ['govern', 'map', 'measure', 'manage'].forEach(functionName => {
                const functionQuestions = Object.keys(aiRmmControls[functionName]);
                functionQuestions.forEach(subcategoryKey => {
                    const questionId = `${functionName}-${subcategoryKey}`;
                    if (!assessmentData[questionId]) {
                        incomplete.push({
                            function: functionName.toUpperCase(),
                            subcategory: subcategoryKey,
                            title: aiRmmControls[functionName][subcategoryKey].title
                        });
                    }
                });
            });
            
            return {
                isComplete: incomplete.length === 0,
                missing: incomplete,
                completionRate: Math.round(((totalQuestions - incomplete.length) / totalQuestions) * 100)
            };
        }

        function generateQuickInsights() {
            const insights = [];
            const functionScores = {
                govern: calculateFunctionScore('govern'),
                map: calculateFunctionScore('map'),
                measure: calculateFunctionScore('measure'),
                manage: calculateFunctionScore('manage')
            };

            // Find strongest and weakest areas
            const validScores = Object.entries(functionScores).filter(([_, score]) => score !== null);
            if (validScores.length > 0) {
                const strongest = validScores.reduce((max, current) => current[1] > max[1] ? current : max);
                const weakest = validScores.reduce((min, current) => current[1] < min[1] ? current : min);
                
                insights.push({
                    type: 'strength',
                    title: `Strongest Area: ${strongest[0].toUpperCase()}`,
                    value: strongest[1].toFixed(1),
                    description: `Your organization excels in ${strongest[0]} with a score of ${strongest[1].toFixed(1)}`
                });
                
                if (strongest[0] !== weakest[0]) {
                    insights.push({
                        type: 'improvement',
                        title: `Focus Area: ${weakest[0].toUpperCase()}`,
                        value: weakest[1].toFixed(1),
                        description: `Consider prioritizing improvements in ${weakest[0]} (score: ${weakest[1].toFixed(1)})`
                    });
                }
            }

            // Overall maturity insight
            const overallScore = calculateOverallScore();
            if (overallScore) {
                let maturityInsight = '';
                if (overallScore < 2) {
                    maturityInsight = 'Your organization is in the early stages of AI risk management maturity. Focus on establishing foundational controls.';
                } else if (overallScore < 3) {
                    maturityInsight = 'Your organization has basic AI risk management capabilities. Work on standardizing processes across all functions.';
                } else if (overallScore < 4) {
                    maturityInsight = 'Your organization demonstrates solid AI risk management maturity. Focus on data-driven optimization and metrics.';
                } else {
                    maturityInsight = 'Your organization shows advanced AI risk management maturity. Consider sharing best practices and mentoring others.';
                }
                
                insights.push({
                    type: 'overall',
                    title: 'Overall Maturity Assessment',
                    value: overallScore.toFixed(1),
                    description: maturityInsight
                });
            }

            return insights;
        }

        // Keyboard navigation and shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveProgress();
                        showTemporaryMessage('Progress saved!', 'success');
                        break;
                    case 'p':
                        e.preventDefault();
                        printAssessment();
                        break;
                    case 'r':
                        if (e.shiftKey) {
                            e.preventDefault();
                            resetAssessment();
                        }
                        break;
                    case 'e':
                        e.preventDefault();
                        if (e.shiftKey) {
                            exportResults('json');
                        } else {
                            exportResults('pdf');
                        }
                        break;
                    case '1':
                    case '2':
                    case '3':
                    case '4':
                    case '5':
                        if (e.altKey) {
                            e.preventDefault();
                            const level = parseInt(e.key);
                            selectCurrentQuestionLevel(level);
                        }
                        break;
                }
            }
            
            // Tab navigation
            if (e.key === 'Tab' && e.shiftKey) {
                // Custom tab navigation logic could go here
            }
        });

        function showTemporaryMessage(message, type = 'info') {
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 8px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                transform: translateX(100%);
                transition: transform 0.3s ease;
                ${type === 'success' ? 'background: #27ae60;' : 
                  type === 'error' ? 'background: #e74c3c;' : 
                  'background: #3498db;'}
            `;
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            
            setTimeout(() => messageDiv.style.transform = 'translateX(0)', 100);
            setTimeout(() => messageDiv.style.transform = 'translateX(100%)', 3000);
            setTimeout(() => document.body.removeChild(messageDiv), 3500);
        }

        function selectCurrentQuestionLevel(level) {
            const activeTab = document.querySelector('.tab.active');
            if (activeTab) {
                const tabContent = document.querySelector(`#${activeTab.onclick.toString().match(/showTab\('(\w+)'\)/)[1]}`);
                const firstUnselected = tabContent.querySelector('.question:not(.completed) .maturity-level:nth-child(' + level + ')');
                if (firstUnselected) {
                    firstUnselected.click();
                }
            }
        }

        // Accessibility enhancements
        function enhanceAccessibility() {
            // Add ARIA labels and roles
            document.querySelectorAll('.maturity-level').forEach((level, index) => {
                level.setAttribute('role', 'radio');
                level.setAttribute('tabindex', '0');
                level.setAttribute('aria-label', `Maturity level ${(index % 5) + 1}`);
                
                // Keyboard navigation for maturity levels
                level.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.click();
                    }
                    if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
                        e.preventDefault();
                        const next = this.nextElementSibling;
                        if (next) next.focus();
                    }
                    if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
                        e.preventDefault();
                        const prev = this.previousElementSibling;
                        if (prev) prev.focus();
                    }
                });
            });

            // High contrast mode detection and support
            if (window.matchMedia('(prefers-contrast: high)').matches) {
                document.body.classList.add('high-contrast');
            }

            // Reduced motion support
            if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.body.classList.add('reduced-motion');
            }
        }

        // Performance monitoring and optimization
        function initializePerformanceMonitoring() {
            let performanceStartTime = Date.now();
            
            window.aiRmmPerformance = {
                startTime: performanceStartTime,
                getElapsedTime: () => Date.now() - performanceStartTime,
                logMetric: (name, value) => {
                    if (window.console && console.log) {
                        console.log(`AI-RMM Metric - ${name}:`, value);
                    }
                }
            };
        }

        // Initialize everything when page loads
        window.addEventListener('load', function() {
            loadProgress();
            enhanceAccessibility();
            initializePerformanceMonitoring();
            
            // Show welcome message for new users
            if (Object.keys(assessmentData).length === 0) {
                setTimeout(() => {
                    if (confirm('Welcome to the AI-RMM Comprehensive Assessment! This evaluation covers all detailed controls from the AI Resilience Maturity Model framework.\n\nWould you like a quick tour of the features?')) {
                        showFeatureTour();
                    }
                }, 1000);
            }
        });

       function showFeatureTour() {
            const features = [
                '🚀 Complete NIST AI-RMF coverage with 17+ control areas',
                '📊 Real-time analytics & interactive charts',
                '💾 Auto-save progress (Ctrl+S)',
                '📄 Comprehensive reporting (Ctrl+E)',
                '🎯 Personalized recommendations',
                '⌨️ Keyboard shortcuts (Ctrl+P for print)',
                '📱 Mobile-friendly responsive design',
                '♿ Full accessibility support',
                '🔄 Progress tracking across all functions'
            ];
            
            alert('🎯 AI-RMM Features Overview:\n\n' + features.join('\n') + '\n\nStart with any function tab above. Your progress is automatically saved!\n\nPress Ctrl+? anytime for keyboard shortcuts.');
        }

        // Help system and documentation
        function showKeyboardShortcuts() {
            const shortcuts = `
🔥 AI-RMM Keyboard Shortcuts

📊 Assessment Navigation:
• Tab / Shift+Tab: Navigate between elements
• Alt+1-5: Quick select maturity levels
• Enter/Space: Select highlighted option

💾 Data Management:
• Ctrl+S: Save progress manually
• Ctrl+Shift+R: Reset entire assessment
• Ctrl+L: Load saved progress

📄 Export & Reporting:
• Ctrl+E: Export comprehensive PDF report
• Ctrl+Shift+E: Export raw JSON data
• Ctrl+P: Print assessment summary
• Ctrl+Shift+P: Print detailed report

🧭 Navigation:
• Ctrl+1: Go to GOVERN tab
• Ctrl+2: Go to MAP tab  
• Ctrl+3: Go to MEASURE tab
• Ctrl+4: Go to MANAGE tab
• Ctrl+5: Go to RESULTS tab

🔧 Utilities:
• Ctrl+?: Show this help
• Ctrl+I: Show quick insights
• Ctrl+V: Validate assessment completeness
• F11: Toggle fullscreen mode
            `;
            
            alert(shortcuts);
        }

        // Quick insights display
        function displayQuickInsights() {
            const insights = generateQuickInsights();
            const validation = validateAssessmentCompleteness();
            
            let insightsText = '🎯 Quick Assessment Insights:\n\n';
            insightsText += `📊 Completion: ${validation.completionRate}% (${Object.keys(assessmentData).length}/${totalQuestions} questions)\n\n`;
            
            insights.forEach(insight => {
                const icon = insight.type === 'strength' ? '💪' : 
                           insight.type === 'improvement' ? '📈' : 
                           insight.type === 'overall' ? '🎯' : '📋';
                insightsText += `${icon} ${insight.title}: ${insight.value}\n`;
                insightsText += `   ${insight.description}\n\n`;
            });
            
            if (validation.missing.length > 0) {
                insightsText += `⚠️ Missing Assessments (${validation.missing.length}):\n`;
                validation.missing.slice(0, 5).forEach(item => {
                    insightsText += `• ${item.function} ${item.subcategory}: ${item.title}\n`;
                });
                if (validation.missing.length > 5) {
                    insightsText += `... and ${validation.missing.length - 5} more\n`;
                }
            }
            
            alert(insightsText);
        }

        // Enhanced keyboard navigation
        document.addEventListener('keydown', function(e) {
            // Handle additional keyboard shortcuts
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case '?':
                        e.preventDefault();
                        showKeyboardShortcuts();
                        break;
                    case 'i':
                        e.preventDefault();
                        displayQuickInsights();
                        break;
                    case 'v':
                        e.preventDefault();
                        const validation = validateAssessmentCompleteness();
                        const message = validation.isComplete ? 
                            '✅ Assessment is complete!' : 
                            `⚠️ Assessment is ${validation.completionRate}% complete. ${validation.missing.length} questions remaining.`;
                        showTemporaryMessage(message, validation.isComplete ? 'success' : 'info');
                        break;
                    case 'l':
                        e.preventDefault();
                        loadProgress();
                        showTemporaryMessage('Progress reloaded!', 'info');
                        break;
                    case '1':
                    case '2':
                    case '3':
                    case '4':
                    case '5':
                        if (!e.altKey) {
                            e.preventDefault();
                            const tabs = ['govern', 'map', 'measure', 'manage', 'results'];
                            const tabIndex = parseInt(e.key) - 1;
                            if (tabs[tabIndex]) {
                                showTab(tabs[tabIndex]);
                                document.querySelector(`[onclick="showTab('${tabs[tabIndex]}')"]`).focus();
                            }
                        }
                        break;
                }
            }
            
            // ESC key handling
            if (e.key === 'Escape') {
                // Close any open modals or reset focus
                document.activeElement.blur();
            }
            
            // F11 fullscreen toggle
            if (e.key === 'F11') {
                e.preventDefault();
                toggleFullscreen();
            }
        });

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log('Fullscreen not supported or denied');
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        // Advanced analytics and reporting
        function generateDetailedAnalytics() {
            const analytics = {
                timestamp: new Date().toISOString(),
                assessment: {
                    totalQuestions: totalQuestions,
                    completedQuestions: Object.keys(assessmentData).length,
                    completionRate: Math.round((Object.keys(assessmentData).length / totalQuestions) * 100)
                },
                scores: {
                    govern: calculateFunctionScore('govern'),
                    map: calculateFunctionScore('map'),
                    measure: calculateFunctionScore('measure'),
                    manage: calculateFunctionScore('manage'),
                    overall: calculateOverallScore()
                },
                distribution: {
                    level1: Object.values(assessmentData).filter(v => v === 1).length,
                    level2: Object.values(assessmentData).filter(v => v === 2).length,
                    level3: Object.values(assessmentData).filter(v => v === 3).length,
                    level4: Object.values(assessmentData).filter(v => v === 4).length,
                    level5: Object.values(assessmentData).filter(v => v === 5).length
                },
                insights: generateQuickInsights(),
                gaps: calculateGapAnalysis(),
                recommendations: generateRecommendationsData()
            };
            
            return analytics;
        }

        // Session management
        function trackSessionMetrics() {
            const sessionData = {
                startTime: window.assessmentStartTime || Date.now(),
                currentTime: Date.now(),
                totalTimeSpent: Date.now() - (window.assessmentStartTime || Date.now()),
                questionsAnswered: Object.keys(assessmentData).length,
                tabSwitches: window.tabSwitchCount || 0,
                saveCount: window.saveCount || 0
            };
            
            // Store session metrics
            try {
                localStorage.setItem('ai-rmm-session-metrics', JSON.stringify(sessionData));
            } catch (e) {
                console.log('Could not save session metrics');
            }
            
            return sessionData;
        }

        // Initialize session tracking
        window.tabSwitchCount = 0;
        window.saveCount = 0;
        
        // Override existing functions to add tracking
        const originalShowTab = showTab;
        showTab = function(tabName) {
            window.tabSwitchCount++;
            return originalShowTab.call(this, tabName);
        };
        
        const originalSaveProgress = saveProgress;
        saveProgress = function() {
            window.saveCount++;
            return originalSaveProgress.call(this);
        };

        // Error handling and debugging
        window.addEventListener('error', function(e) {
            console.error('AI-RMM Error:', e.error);
            showTemporaryMessage('An error occurred. Check console for details.', 'error');
            
            // Log error details for debugging
            const errorDetails = {
                message: e.message,
                filename: e.filename,
                lineno: e.lineno,
                colno: e.colno,
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                url: window.location.href
            };
            
            console.log('Error Details:', errorDetails);
        });

        // Unhandled promise rejection handling
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Unhandled Promise Rejection:', e.reason);
            showTemporaryMessage('A background error occurred.', 'error');
        });

        // Cleanup and beforeunload handling
        window.addEventListener('beforeunload', function(e) {
            // Auto-save progress before leaving
            saveProgress();
            trackSessionMetrics();
            
            // Show confirmation if assessment is incomplete
            const validation = validateAssessmentCompleteness();
            if (!validation.isComplete && Object.keys(assessmentData).length > 0) {
                e.preventDefault();
                e.returnValue = 'You have an incomplete assessment. Are you sure you want to leave?';
                return e.returnValue;
            }
        });

        // Page visibility handling for auto-save
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'hidden') {
                // Save progress when tab becomes hidden
                saveProgress();
                trackSessionMetrics();
            }
        });

        // Touch and mobile support
        function initializeMobileSupport() {
            // Add touch support for maturity level selection
            document.addEventListener('touchstart', function(e) {
                // Improve touch responsiveness
            }, { passive: true });
            
            // Handle orientation changes
            window.addEventListener('orientationchange', function() {
                setTimeout(() => {
                    // Recalculate layouts if needed
                    if (charts.maturity) charts.maturity.resize();
                    if (charts.function) charts.function.resize();
                    if (charts.progress) charts.progress.resize();
                    if (charts.gap) charts.gap.resize();
                }, 100);
            });
        }

        // Browser compatibility checks
        function checkBrowserCompatibility() {
            const issues = [];
            
            // Check for localStorage support
            if (typeof Storage === 'undefined') {
                issues.push('Local storage not supported - progress saving disabled');
            }
            
            // Check for modern JavaScript features
            if (!Array.prototype.includes) {
                issues.push('Modern JavaScript features not supported');
            }
            
            // Check for Canvas support (for charts)
            const canvas = document.createElement('canvas');
            if (!canvas.getContext) {
                issues.push('Canvas not supported - charts may not work');
            }
            
            if (issues.length > 0) {
                console.warn('Browser compatibility issues:', issues);
                showTemporaryMessage('Some features may not work in this browser.', 'error');
            }
            
            return issues;
        }

        // Final initialization
        window.addEventListener('load', function() {
            console.log('🚀 Starting AI-RMM Dashboard initialization...');
            
            // Check browser compatibility
            checkBrowserCompatibility();
            
            // Initialize mobile support
            initializeMobileSupport();
            
            // Load saved progress
            loadProgress();
            
            // Enhance accessibility
            enhanceAccessibility();
            
            // Initialize performance monitoring
            initializePerformanceMonitoring();
            
            // Track session start
            window.assessmentStartTime = Date.now();
            
            // Show welcome message for new users
            if (Object.keys(assessmentData).length === 0) {
                setTimeout(() => {
                    if (confirm('Welcome to the AI-RMM Comprehensive Assessment! This evaluation covers all detailed controls from the AI Resilience Maturity Model framework.\n\nWould you like a quick tour of the features?')) {
                        showFeatureTour();
                    }
                }, 1000);
            }
            
            // Log successful initialization
            console.log('✅ AI-RMM Dashboard initialization complete');
            console.log('📊 Framework Details:');
            console.log('  • Total Controls:', totalQuestions);
            console.log('  • Framework Version: v1.0');
            console.log('  • Based on: NIST AI Risk Management Framework');
            console.log('  • Functions: GOVERN, MAP, MEASURE, MANAGE');
            console.log('  • Maturity Levels: 1 (Initial) to 5 (Optimizing)');
            console.log('');
            console.log('⌨️ Keyboard Shortcuts:');
            console.log('  • Ctrl+S: Save Progress');
            console.log('  • Ctrl+P: Print Summary');
            console.log('  • Ctrl+E: Export PDF Report');
            console.log('  • Ctrl+Shift+E: Export JSON Data');
            console.log('  • Ctrl+Shift+R: Reset Assessment');
            console.log('  • Ctrl+1-5: Navigate to function tabs');
            console.log('  • Alt+1-5: Quick select maturity levels');
            console.log('  • Ctrl+?: Show all shortcuts');
            console.log('  • Ctrl+I: Show quick insights');
            console.log('');
            console.log('🎯 Ready for assessment! Start with any function tab above.');
            
            // Final performance log
            const loadTime = Date.now() - (window.aiRmmLoadStart || Date.now());
            console.log(`⚡ Total load time: ${loadTime}ms`);
        });

        // Set load start time
        window.aiRmmLoadStart = Date.now();

        // Global error boundary
        try {
            // Validate critical functions exist
            if (typeof initializeAssessment !== 'function') {
                throw new Error('Critical functions not loaded properly');
            }
            
            console.log('🔍 AI-RMM Framework validation passed');
        } catch (error) {
            console.error('🚨 Critical initialization error:', error);
            document.body.innerHTML = `
                <div style="
                    position: fixed; 
                    top: 50%; 
                    left: 50%; 
                    transform: translate(-50%, -50%); 
                    background: #e74c3c; 
                    color: white; 
                    padding: 20px; 
                    border-radius: 8px; 
                    text-align: center;
                ">
                    <h2>🚨 AI-RMM Dashboard Error</h2>
                    <p>A critical error occurred during initialization.</p>
                    <p>Please refresh the page or contact support.</p>
                    <button onclick="location.reload()" style="
                        background: white; 
                        color: #e74c3c; 
                        border: none; 
                        padding: 10px 20px; 
                        border-radius: 4px; 
                        cursor: pointer; 
                        margin-top: 10px;
                    ">Refresh Page</button>
                </div>
            `;
        }

    </script>
</body>
</html>
airmm.html
Displaying airmm.html.
